{% extends "base.html" %}

{% block title %}Dashboard - Secure Notes{% endblock %}

{% block content %}
<div class="dashboard">
  <div class="dashboard-header">
    <h1>Your Notes</h1>
    <a href="{{ url_for('main.create_note') }}" class="btn btn-primary">
      + New Note
    </a>
  </div>

  {% if notes %}
  <div class="notes-grid">
    {% for note in notes %}
    <div class="note-card">
      <div class="note-card-header">
        <!-- Title is auto-escaped by Jinja2 to prevent XSS -->
        <h3 class="note-title">{{ note.title }}</h3>
        <span class="note-date">
          {{ note.updated_at.strftime('%d %b %Y') }}
        </span>
      </div>
      <div class="note-card-body">
        <!-- Content preview - also auto-escaped -->
        <p class="note-preview">
          {% if note._decrypted_content %}
          {{ note._decrypted_content[:150] }}{% if note._decrypted_content|length > 150 %}...{% endif %}
          {% else %}
          {{ note.content[:150] }}{% if note.content|length > 150 %}...{% endif %}
          {% endif %}
        </p>
      </div>
      <div class="note-card-footer">
        <a href="{{ url_for('main.view_note', note_id=note.id) }}" class="btn btn-secondary btn-sm">
          View
        </a>
        <a href="{{ url_for('main.edit_note', note_id=note.id) }}" class="btn btn-outline btn-sm">
          Edit
        </a>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="empty-state">
    <div class="empty-icon">üìù</div>
    <h2>No notes yet</h2>
    <p>Start by creating your first secure note!</p>
    <a href="{{ url_for('main.create_note') }}" class="btn btn-primary">
      Create Your First Note
    </a>
  </div>
  {% endif %}
</div>
{% endblock %}